!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t(require("jquery")):t(jQuery)}(function(t){function e(t,e){window.console&&"undefined"!=typeof t&&t&&"undefined"!=typeof e&&e&&(t=t.toLowerCase())}function i(t){return t.toString().match(/\d+/)[0]}function n(t,e){var i=t.toString().match(/(-*)+\d+/)[0];return"px"==o(t)?0>t?0:t>e?e:t:"%"==o(t)?0>i?"0%":i>100?"100%":t:void 0}function o(e){var i=e.toString().match(/\d+(.*)/i);if(i)switch(t.trim(i[1])){case"":return"px";case"px":return"px";case"%":return"%"}}function s(e,i){this.element=e,this.settings=t.extend({},p,i),this.settings.width=this.settings.width.toString().replace(/px/gi,""),this.settings.height=this.settings.height.toString().replace(/px/gi,""),this.settings.position.y=n(this.settings.position.y,this.settings.width),this.settings.position.x=n(this.settings.position.x,this.settings.height),this.settings.zoom=this.settings.zoom<0?0:this.settings.zoom,"string"==typeof i?"kill"==i.toLowerCase()&&this.kill(this.element):(t(this.element).data(l,this.settings),this.init())}var a=function(){var t=document.createElement("div"),e="Khtml Ms O Moz Webkit".split(" ");e.length;return function(i){if(i in t.style)return!0;i=i.replace(/^[a-z]/,function(t){return t.toUpperCase()});for(var n in e)if(e[n]+i in t.style)return!0;return!1}}(),h="jqthumb",r=h+"-resize",d=h+"-original-styles",l=h+"-options",u={outputElems:[],inputElems:[]},p={classname:h,width:100,height:100,position:{x:"50%",y:"50%"},source:"src",responsive:20,zoom:1,show:!0,method:"auto",reinit:!0,before:function(){},after:function(){},done:function(){}};s.prototype={init:function(){var t=this.settings.method.toLowerCase();"auto"==t?a("backgroundSize")===!1?this["native"](this.element,this.settings):this.modern(this.element,this.settings):"modern"==t?this.modern(this.element,this.settings):"native"==t?this["native"](this.element,this.settings):e("error",'Invalid method. Only "auto", "modern" and "native" are allowed.')},kill:function(i){var n=t(i);if(n.data(h)){var o=[],s=n.prev();if(s.data(h)!==h)return e("error","Could not find the element. It is probably due to one or more element has been added right before the image element after the plugin initialization or it was removed."),!1;o=[],t.each(u.outputElems,function(e,i){t(i)[0]!=s[0]&&o.push(u.outputElems[e])}),u.outputElems=o,o=[],t.each(u.inputElems,function(e,i){t(i)[0]!=n[0]&&o.push(u.inputElems[e])}),u.inputElems=o,s.data(r)&&(t(window).unbind("resize",s.data(r)),s.removeData(r)),s.remove(),n.removeAttr("style"),"undefined"!=typeof n.data(d)&&(n.attr("style",n.data(d)),n.removeData(d)),"undefined"!=typeof n.data(h)&&n.removeData(h),"undefined"!=typeof n.data(l)&&n.removeData(l)}},"native":function(e,n){n.before.apply(e,[e]);var s=this,a=t(e),l=t("<img/>");a.data(d,a.attr("style")),a.hide(),l.bind("load",function(){var d={obj:l,size:{width:this.width,height:this.height}},u=(o(n.width),o(n.height),n.responsive),p=t(d.obj),g=t("<div />"),c=0,f=function(){setTimeout(function(){m()},u)},m=function(){var e=p.parent(),s=e.height(),a=e.width(),h=n.zoom,r=n.position.x,l=n.position.y;if(d.size.width>d.size.height?(p.css({width:"auto","max-height":99999999,"min-height":0,"max-width":99999999,"min-width":0,height:s+"px"}),c=p.height()/p.width(),p.width()<a?p.css({width:a*h,height:parseFloat(a*c)*h}):p.css({width:p.width()*h,height:parseFloat(p.width()*c)*h})):(p.css({width:a+"px","max-height":99999999,"min-height":0,"max-width":99999999,"min-width":0,height:"auto"}),c=p.width()/p.height(),p.height()<s&&p.css({width:parseFloat(s*c)*h,height:s*h})),n.zoom<1){var u=t("<div />"),g=n.width.toString(),f=n.height.toString(),m=o(g),w=o(f);u.css({width:parseFloat(i(g)*n.zoom)+m,height:parseFloat(i(f)*n.zoom)+w,position:"relative",overflow:"hidden"}).appendTo(p.parent()),p.appendTo(u)}p.css({position:"absolute",left:function(){var t=0;return"%"==o(r)?(t=parseFloat((p.width()-p.parent().width())/100*i(r)),0>=t?t+"px":"-"+t+"px"):"px"==o(r)||isNaN(r)===!1?i(r)+"px":void 0}(),top:function(){var t=0;return"%"==o(l)?(t=parseFloat((p.height()-p.parent().height())/100*i(l)),0>=t?t+"px":"-"+t+"px"):"px"==o(l)||isNaN(l)===!1?i(l)+"px":void 0}()})};g.insertBefore(a).append(p).css({position:"relative",overflow:"hidden",width:i(n.width)+o(n.width),height:i(n.height)+o(n.height)}).data(h,h),m(),!isNaN(u)&&u>0&&(g.data(r,f),t(window).bind("resize",g.data(r))),g.hide().addClass(n.classname),n.show===!0&&g.show(),n.after.apply(e,[g]),s.updateGlobal(e,g,n)}).attr("src",a.attr(n.source))},modern:function(e,n){n.before.apply(e,[e]);var s=this,a=t(e),r=t("<img />").attr("src",a.attr(n.source));a.data(d,a.attr("style")),a.hide(),t.each(r,function(r,d){var l=t(d);l.one("load",function(){var r=n.width,d=n.height,l=n.zoom,u=n.position.x,p=n.position.y,g=null,c=null;g=t("<div/>").css({width:i(r)+o(r),height:i(d)+o(d),position:"relative",overflow:"hidden"}).addClass(n.classname).data(h,h),c=t("<div/>").css({width:"100%",height:"100%","background-image":'url("'+a.attr(n.source)+'")',"background-repeat":"no-repeat","background-position":i(u)+o(u)+" "+i(p)+o(p),"background-size":"cover"}).appendTo(g),g.insertBefore(t(e)),g.show(),c.css({width:parseFloat(100*l)+"%",height:parseFloat(100*l)+"%",position:"absolute"}).css({top:function(){var t=g.height(),e=c.height();return"%"==o(p)?"-"+parseFloat((e-t)/t*100/(100/i(p)))+"%":void 0}(),left:function(){var t=g.width(),e=c.width();return"%"==o(u)?"-"+parseFloat((e-t)/t*100/(100/i(u)))+"%":void 0}()}),g.hide(),n.show===!0&&g.show(),n.after.apply(e,[g]),s.updateGlobal(e,g,n)})})},updateGlobal:function(e,i,n){e.global.outputElems.push(t(i)[0]),e.global.elemCounter++,u.outputElems.push(t(i)[0]),e.global.elemCounter==e.global.inputElems.length&&n.done.apply(e,[e.global.outputElems])}},t.fn[h]=function(i){var n={},o={elemCounter:0,outputElems:[],inputElems:function(e){for(var i=t(e),n=i.length,o=[],s=0;n>s;s++)o.push(i.get(s));return o}(t(this))};return n[h]=function(i){return"undefined"==typeof i?void e("error","Please specify an action like $."+h+'("killall")'):(i=i.toLowerCase(),void("killall"==i&&t.each(u.inputElems,function(){new s(this,"kill")})))},t.extend(t,n),this.each(function(){var e=t(this);this.global=o,u.inputElems.push(e),"string"==typeof i?new s(this,i):e.data(h)?e.data(l)&&e.data(l).reinit===!0&&(new s(this,"kill"),e.data(h,new s(this,i))):e.data(h,new s(this,i))})}});