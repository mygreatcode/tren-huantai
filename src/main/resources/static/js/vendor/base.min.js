$.utils || ($.utils = {}),
    $.utils = $.extend(jQuery.utils, {

        log: function() {
            var e = this;
            return e.isIE([6, 7, 8]) && $(".console").append(arguments.join(",")),
                arguments
        },
        isIE: function(e) {
            if (e instanceof Array) {
                var t, n = this;
                return e.forEach(function(e) {
                    t = t ? t: n.isIE(e)
                }),
                    t
            }
            var o = document.createElement("b");
            return o.innerHTML = "<!--[if IE " + e + "]><i></i><![endif]-->",
            1 === o.getElementsByTagName("i").length
        },
        alert: function(e) {
            var t = avalon.vmodels.alertdialog;
            if (! (!t || t.toggle || t.isReady < 1)) {
                var n = function() {};
                "string" == typeof e && (e = {
                    content: e,
                    type: "alert"
                }),
                    $.extend(t, {
                            title: "",
                            content: "",
                            cancelText: "\u53d6\u6d88",
                            confirmText: "\u786e\u5b9a",
                            type: "alert",
                            onCancel: n,
                            onOpen: n,
                            onClose: n,
                            onConfirm: n
                        },
                        e),
                    t.toggle = !0
            }
        },
        getCityUrl: function(e) {
            return "/" + currentCity + e
        },
        urlParms: function(e) {
            var t = window.location.search.substring(1),
                n = t.split("&"),
                o = {};
            if ("" == t) return e ? null: {};
            for (var a = 0; a < n.length; a++) {
                var i = n[a].split("=");
                o[i[0]] = i[1]
            }
            return e ? o[e] : o
        },
        urlEncode: function(e) {
            var t = [];
            for (var n in e) e.hasOwnProperty(n) && t.push([n, e[n]].join("="));
            return t.join("&")
        },
        uploadLeaving: function(e, t) {
            $.ajax({
                type: "POST",
                url: "/" + currentCity + "/leaving",
                data: e,
                async: !0,
                error: function(e) {
                    t && t(e, "error")
                },
                success: function(e) {
                    t && t(e, "success")
                }
            })
        }
    }),
    function() {
        function e() {
            function e(e) {
                var t, n = window.navigator.userAgent,
                    o = /micromessenger/gi,
                    a = /([a-z]+)\/house\/(\d+)/,
                    i = /([a-z]+)\/new-house\/detail\/\?id=(\d+)/,
                    r = /([a-z]+)\/new-house\/detail\?id=(\d+)/,
                    s = /([a-z]+)\/new-house\/search/,
                    c = /([a-z]+)\/rent\/detail\/(\d+)/,
                    l = /([a-z]+)\/rent\/index/,
                    u = e.match(a),
                    h = e.match(i),
                    d = e.match(r),
                    m = e.match(c),
                    p = e.match(s),
                    v = e.match(l);
                return o.test(n) ? (t = u && u.length > 2 ? "https://www.huantai1.com/" + u[1] + "/house/" + u[2] + "/": "https://www.huantai1.com/", h && h.length > 2 && (t = "https://www.huantai1.com/" + h[1] + "/new-house/detail/?id=" + h[2] + "/"), d && d.length > 2 && (t = "https://www.huantai1.com/" + d[1] + "/new-house/detail/?id=" + d[2] + "/"), p && (t = "https://www.huantai1.com/" + p[1] + "/new-house/search/"), m && m.length > 2 && (t = "https://www.huantai1.com/" + m[1] + "/rent/detail/" + m[2] + "/"), v && (t = "https://www.huantai1.com/" + v[1] + "/rent/search")) : t = "https://www.huantai1.com",
                    t
            }
            for (var t = navigator.platform,
                     n = window.location.href,
                     o = new Array("iPhone", "iPod", "android", "Nokia", "SymbianOS", "Symbian", "Windows Phone", "Phone", "Linux armv71", "Linux armv7l", "Linux armv8l", "Linux aarch64", "MAUI", "UNTRUSTED/1.0", "Windows CE", "BlackBerry", "IEMobile"), a = e(n), i = !0, r = 0; r < o.length; r++) if (t.indexOf(o[r]) >= 0) {
                i = !1;
                break
            }
            i || (window.location = a)
        }
        function t() {
            var e = window.location.search,
                t = {};
            if ( - 1 != e.indexOf("?")) {
                var n = e.substr(1);
                strs = n.split("&");
                for (var o = 0; o < strs.length; o++) t[strs[o].split("=")[0]] = decodeURI(strs[o].split("=")[1])
            }
            return t
        }
        function n(e) {
            var t, n = new RegExp("(^| )" + e + "=([^;]*)(;|$)");
            return (t = document.cookie.match(n)) ? unescape(t[2]) : null
        }

       // $.utils.isIE([6, 7, 8]) ? (document.onfocusin = a, document.onfocusout = i) : (window.onfocus = a, window.onblur = i);
        var r = {};
        r = t();
        var s = n("noJump"),
            c = r.desktop ? r.desktop: s;
        if (c) return o("noJump", "desktop", 1),
            !1;
        e();
        var l = $(".enrollClose"),
            u = $(".enrollIco");
        l.on("click",
            function() {
                u.hide()
            }),
            $(".test_ico_sss").on("click",
                function() {})
    } (),
    require(["../component/dialog/avalon.dialog?1", "../component/draggable/avalon.draggable"],
        function() {
            avalon.duplexHooks.checked = {
                get: function(e, t) {
                    return "checked-string" == t.param ? t.oldValue ? !t.oldValue: e: !t.oldValue
                }
            },
                avalon.filters.round = function(e, t) {
                    e = (e + "").replace(/[^0-9+\-Ee.]/g, "");
                    var n = isFinite( + e) ? +e: 0,
                        o = isFinite( + t) ? Math.abs(t) : 3,
                        a = ".",
                        i = "",
                        r = function(e, t) {
                            var n = Math.pow(10, t);
                            return "" + (Math.round(e * n) / n).toFixed(t)
                        };
                    return i = (o ? r(n, o) : "" + Math.round(n)).split("."),
                    (i[1] || "").length < o && (i[1] = i[1] || "", i[1] += new Array(o - i[1].length + 1).join("0")),
                        i.join(a)
                },
                avalon.config({
                    interpolate: ["{:", ":}"]
                });
            avalon.define({
                $id: "public_page",
                alert: {},
                footer: {
                    changeTab: function(e) {
                        var t, n, o = $(e.target);
                        o.hasClass("tab_btn") && (n = $(this).find(".tab"), t = o.index(), o.addClass("active").siblings().removeClass("active"), n.removeClass("active").eq(t).addClass("active"))
                    }
                }
            });
            avalon.scan()
        }),
    $(function() {
        function e(e, t) {
            $(e).on("keydown",
                function(e) {
                    var n = $(this),
                        o = n.val();
                    if (13 == e.which) switch (t) {
                        case "house":
                            location.href = "/" + currentCity + "/search?key=" + o;
                            break;
                        case "new_house":
                            location.href = "/" + currentCity + "/new-house/search/?wd=" + o;
                            break;
                        case "rent":
                            location.href = "/" + currentCity + "/rent/index/?wd=" + o;
                            break;
                        case "community":
                            location.href = "/" + currentCity + "/communities/?key=" + o;
                            break;
                        case "auction":
                            location.href = "/" + currentCity + "/auction/?key=" + o
                    }
                })
        }
        function t(e) {
            return (new Date).toDateString() === new Date(e).toDateString()
        }
        function n() {
            d.show()
        }
        function o() {
            d.hide(),
                g.val(""),
                _.val(""),
                k = "\u968f\u65f6\u8054\u7cfb",
                v.html(b[0]),
                p.removeClass("active").eq(0).addClass("active")
        }
        e("#home_search", "house"),
            e("#home_new_house", "new_house"),
            e("#home_rent", "rent"),
            e("#home_community", "community"),
            e("#search_list", "house"),
            e("#house_detail_search", "house"),
            e("#community_list", "community"),
            e("#community_detail_search", "community"),
            e("#auction_detail_search", "auction");
        var a = $(".other-link"),
            i = a.find(".tab_btn"),
            r = a.find(".tab");
        a.on("click",
            function(e) {
                e.stopPropagation();
                var t = $(e.target);
                t.hasClass("tab_btn") && (t.hasClass("active") || (i.removeClass("active"), t.addClass("active"), r.removeClass("active"), r.eq(i.index(t)).addClass("active")))
            });
        var s = $(".tab_menu ul"),
            c = $(".tab_box .tab");
        s.on("mouseover", "li",
            function(e) {
                var t = $(e.currentTarget),
                    n = t.index();
                t.addClass("active").siblings("li").removeClass("active"),
                    c.eq(n).addClass("active").siblings("div").removeClass("active")
            });
        var l = $(".iphoneIco"),
            u = $(".androidIco");
        l.on("click",
            function(e) {
                e.preventDefault(),
                    setTimeout(function() {
                            window.open("安装包下载")
                        },
                        500)
            }),
            u.on("click",
                function(e) {
                    e.preventDefault(),
                        setTimeout(function() {
                                window.open("安装包下载")
                            },
                            500)
                });
        var h = $(".list_ad_banner");
        t(localStorage.getItem("new_house_hide")) ? ($(".new_house_ad_banner").hide(), $(".new-house").removeClass("no_border")) : localStorage.removeItem("new_house_hide"),
            t(localStorage.getItem("rent_house_hide")) ? $(".rent_house_ad_banner").hide() : localStorage.removeItem("rent_house_hide"),
            t(localStorage.getItem("second_house_hide")) ? ($(".second_house_ad_banner").hide(), $(".second_house_list").removeClass("no_border")) : localStorage.removeItem("second_house_hide"),
            t(localStorage.getItem("community_hide")) ? ($(".community_ad_banner").hide(), $(".community_item").removeClass("no_border")) : localStorage.removeItem("community_hide"),
            $(".list_ad_close").on("click",
                function() {
                    var e = $(this),
                        t = e.attr("data-type");
                    h.hide(),
                        e.parent().prev().removeClass("no_border"),
                        localStorage.setItem(t + "_hide", (new Date).toDateString())
                }),
            $('input[type="text"],input[type="number"]').attr("growing-track", !0);
        var d = $(".help_popup_mask"),
            m = $(".help_popup_close_btn"),
            p = $(".choose_time_item"),
            v = $(".choose_time_tips"),
            f = $(".help_popup_title"),
            _ = $(".help_popup_msg"),
            g = $(".help_popup_tel"),
            w = $(".help_popup_btn"),
            y = $(".show_popup_btn"),
            b = ["\u9a6c\u4e0a\u627e\u623f\uff0c\u523b\u4e0d\u5bb9\u7f13", "\u6b63\u5728\u6570\u94b1\u4e2d\uff0c\u665a\u4e0a\u4e03\u70b9\u540e\u8054\u7cfb", "\u65e9\u4e70\u65e9\u8d5a\uff0c\u65f6\u4e0d\u5f85\u6211"],
            C = "\u5e2e\u6211\u627e\u623f",
            k = "\u968f\u65f6\u8054\u7cfb";
        m.on("click",
            function() {
                o()
            }),
            p.on("click",
                function() {
                    var e = $(this),
                        t = e.attr("data-time"),
                        n = e.attr("data-tip");
                    e.addClass("active").siblings().removeClass("active"),
                        v.html(b[n]),
                        k = t
                }),
            y.on("click",
                function() {
                    var e, t, o, a = $(this),
                        i = a.attr("data-type");
                    switch ("policy" == i ? v.hide() : v.show(), i) {
                        case "help":
                            e = "\u5e2e\u6211\u627e\u623f",
                                t = "\u7b80\u5355\u63cf\u8ff0\u60a8\u60f3\u8981\u7684\u623f\u5b50\u6216\u5c0f\u533a",
                                o = "\u4ea4\u7ed9\u4f60\u4e86",
                                C = "\u5e2e\u6211\u627e\u623f";
                            break;
                        case "policy":
                            e = "\u9650\u8d2d\u8d44\u683c\u89e3\u8bfb",
                                t = "\u7b80\u5355\u63cf\u8ff0\u60a8\u7684\u95ee\u9898",
                                o = "\u63d0\u4ea4\u95ee\u9898",
                                C = "\u9650\u8d2d\u8d44\u683c\u89e3\u8bfb";
                            break;
                        default:
                            e = "\u5e2e\u6211\u627e\u623f",
                                t = "\u7b80\u5355\u63cf\u8ff0\u4f60\u60f3\u8981\u7684\u623f\u5b50\u6216\u5c0f\u533a",
                                o = "\u4ea4\u7ed9\u4f60\u4e86",
                                C = "\u5e2e\u6211\u627e\u623f"
                    }
                    f.html(e),
                        _.attr("placeholder", t),
                        w.html(o),
                        n()
                });
        var x = !1;
        w.on("click",
            function() {
                var e = _.val(),
                    t = g.val();
                if (!x) {
                    if (e.length < 1) return alert("\u95ee\u9898\u4e0d\u80fd\u4e3a\u7a7a"),
                        !1;
                    var n = /^1[3456789]{1}[0-9]{9}$/;
                    return t.length < 1 ? (alert("\u624b\u673a\u53f7\u4e0d\u80fd\u4e3a\u7a7a"), !1) : n.test(t) ? void $.ajax({
                        url: "/" + currentCity + "/agent/leaving_message/" + popup_agent_id,
                        dataType: "json",
                        method: "POST",
                        data: {
                            telephone: t,
                            message: e,
                            contact_time: k,
                            advisory_type: C
                        },
                        success: function(e) {
                            e.state ? (alert("\u63d0\u4ea4\u6210\u529f"), o()) : alert(e.msg)
                        },
                        error: function(e) {
                            alert("\u7f51\u7edc\u9519\u8bef,\u8bf7\u7a0d\u540e\u518d\u8bd5")
                        }
                    }) : (alert("\u624b\u673a\u53f7\u683c\u5f0f\u586b\u5199\u9519\u8bef"), !1)
                }
            })
    });